{"version":3,"file":"transforms.js","sourceRoot":"","sources":["../../src/transforms.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport {\n  AbstractiveSummarizationLROResult,\n  AnalyzeResponse,\n  AnalyzeTextLROResultUnion,\n  AssessmentSentiment,\n  CustomEntityRecognitionLROResult,\n  CustomMultiLabelClassificationLROResult,\n  CustomSingleLabelClassificationLROResult,\n  DocumentError,\n  EntitiesTaskResult,\n  EntityLinkingLROResult,\n  EntityLinkingTaskResult,\n  EntityRecognitionLROResult,\n  ErrorModel,\n  ErrorResponse,\n  ExtractiveSummarizationLROResult,\n  EntityLinkingResult as GeneratedEntityLinkingResult,\n  EntitiesResult as GeneratedEntityRecognitionResult,\n  HealthcareEntity as GeneratedHealthcareEntity,\n  HealthcareResult as GeneratedHealthcareResult,\n  KeyPhraseResult as GeneratedKeyPhraseExtractionResult,\n  LanguageDetectionResult as GeneratedLanguageDetectionResult,\n  PiiResult as GeneratedPiiEntityRecognitionResult,\n  SentenceSentiment as GeneratedSentenceSentiment,\n  SentimentResponse as GeneratedSentimentAnalysisResult,\n  HealthcareLROResult,\n  HealthcareRelation,\n  HealthcareRelationEntity,\n  InnerErrorModel,\n  KeyPhraseExtractionLROResult,\n  KeyPhraseTaskResult,\n  KnownAnalyzeTextLROResultsKind,\n  LanguageDetectionTaskResult,\n  PiiEntityRecognitionLROResult,\n  PiiTaskResult,\n  SentenceTarget,\n  SentimentLROResult,\n  SentimentTaskResult,\n  TargetRelation,\n  CustomEntitiesResultDocumentsItem,\n  CustomLabelClassificationResultDocumentsItem,\n  HealthcareEntitiesDocumentResult,\n} from \"./generated\";\nimport {\n  AnalyzeActionName,\n  AnalyzeBatchActionName,\n  AnalyzeBatchResult,\n  AnalyzeResult,\n  EntityLinkingResult,\n  EntityRecognitionResult,\n  HealthcareEntity,\n  HealthcareEntityRelation,\n  HealthcareEntityRelationRole,\n  HealthcareResult,\n  HealthcareSuccessResult,\n  KeyPhraseExtractionResult,\n  LanguageDetectionResult,\n  Opinion,\n  PiiEntityRecognitionResult,\n  SentenceSentiment,\n  SentimentAnalysisResult,\n  TextAnalysisError,\n  TextAnalysisErrorResult,\n  TextAnalysisSuccessResult,\n} from \"./models\";\nimport {\n  AssessmentIndex,\n  extractErrorPointerIndex,\n  parseAssessmentIndex,\n  parseHealthcareEntityIndex,\n  sortResponseIdObjects,\n} from \"./util\";\nimport { RestError } from \"@azure/core-rest-pipeline\";\n\n/**\n * Helper function for converting nested service error to the unified\n * TextAnalysisError\n */\nfunction toTextAnalysisError(errorModel: ErrorModel | InnerErrorModel): TextAnalysisError {\n  // Return the deepest error.\n  if (errorModel.innererror !== undefined) {\n    return toTextAnalysisError(errorModel.innererror);\n  }\n\n  return {\n    ...errorModel,\n  };\n}\n\nfunction makeTextAnalysisErrorResult(id: string, error: ErrorModel): TextAnalysisErrorResult {\n  return {\n    id,\n    error: toTextAnalysisError(error),\n  };\n}\n\n/**\n * combines successful and erroneous results into a single array of results and\n * sort them so that the IDs order match that of the input documents array.\n * @param ids - the array of input document IDs.\n * @param response - the response received from the service.\n * @param options - an options bag that includes functions to process the results.\n */\nfunction transformDocumentResults<\n  DocumentSuccess extends TextAnalysisSuccessResult,\n  PublicDocumentSuccess extends TextAnalysisSuccessResult = DocumentSuccess,\n  TError extends TextAnalysisErrorResult = TextAnalysisErrorResult\n>(\n  ids: string[],\n  response: {\n    documents: DocumentSuccess[];\n    errors: DocumentError[];\n  },\n  options?: {\n    processSuccess?: (successResult: DocumentSuccess) => PublicDocumentSuccess;\n    processError?: (id: string, error: ErrorModel) => TError;\n  }\n): (PublicDocumentSuccess | TextAnalysisErrorResult)[] {\n  const { processError = makeTextAnalysisErrorResult, processSuccess } = options || {};\n  const successResults = processSuccess\n    ? response.documents.map(processSuccess)\n    : response.documents;\n  const unsortedResults = (\n    successResults as (PublicDocumentSuccess | TextAnalysisErrorResult)[]\n  ).concat(response.errors.map((error) => processError(error.id, error.error)));\n\n  return sortResponseIdObjects(ids, unsortedResults);\n}\n\nfunction toLanguageDetectionResult(\n  docIds: string[],\n  results: GeneratedLanguageDetectionResult\n): LanguageDetectionResult[] {\n  return transformDocumentResults(docIds, results, {\n    processSuccess: ({ detectedLanguage, ...rest }) => ({\n      primaryLanguage: detectedLanguage,\n      ...rest,\n    }),\n  });\n}\n\nfunction toPiiEntityRecognitionResult(\n  docIds: string[],\n  results: GeneratedPiiEntityRecognitionResult\n): PiiEntityRecognitionResult[] {\n  return transformDocumentResults(docIds, results);\n}\n\nfunction toSentimentAnalysisResult(\n  docIds: string[],\n  results: GeneratedSentimentAnalysisResult\n): SentimentAnalysisResult[] {\n  return transformDocumentResults(docIds, results, {\n    processSuccess: ({ sentences, ...rest }) => ({\n      ...rest,\n      sentences: sentences.map((sentence) =>\n        convertGeneratedSentenceSentiment(sentence, sentences)\n      ),\n    }),\n  });\n}\n\n/**\n * Converts a sentence sentiment object returned by the service to another that\n * is user-friendly.\n *\n * @param sentence - The sentence sentiment object to be converted.\n * @param response - The entire response returned by the service.\n * @returns The user-friendly sentence sentiment object.\n * @internal\n */\nfunction convertGeneratedSentenceSentiment(\n  { targets, assessments: _, ...rest }: GeneratedSentenceSentiment,\n  sentences: GeneratedSentenceSentiment[]\n): SentenceSentiment {\n  return {\n    ...rest,\n    opinions:\n      targets?.map(\n        // eslint-disable-next-line @typescript-eslint/no-shadow\n        ({ relations, ...rest }: SentenceTarget): Opinion => ({\n          target: rest,\n          assessments: relations\n            .filter((relation) => relation.relationType === \"assessment\")\n            .map((relation) => convertTargetRelationToAssessmentSentiment(relation, sentences)),\n        })\n      ) ?? [],\n  };\n}\n\n/**\n * Converts a target relation object returned by the service to an assessment\n * sentiment object where JSON pointers in the former are realized in the\n * latter.\n *\n * @param targetRelation - The target relation object to be converted.\n * @param response - The entire response returned by the service.\n * @returns The user-friendly assessment sentiment object.\n * @internal\n */\nfunction convertTargetRelationToAssessmentSentiment(\n  targetRelation: TargetRelation,\n  sentences: GeneratedSentenceSentiment[]\n): AssessmentSentiment {\n  const assessmentPtr = targetRelation.ref;\n  const assessmentIndex: AssessmentIndex = parseAssessmentIndex(assessmentPtr);\n  const assessment =\n    sentences?.[assessmentIndex.sentence].assessments?.[assessmentIndex.assessment];\n  if (assessment !== undefined) {\n    return assessment;\n  } else {\n    throw new Error(`Pointer \"${assessmentPtr}\" is not a valid Assessment pointer`);\n  }\n}\n\nfunction toEntityLinkingResult(\n  docIds: string[],\n  results: GeneratedEntityLinkingResult\n): EntityLinkingResult[] {\n  return transformDocumentResults(docIds, results);\n}\n\nfunction toKeyPhraseExtractionResult(\n  docIds: string[],\n  results: GeneratedKeyPhraseExtractionResult\n): KeyPhraseExtractionResult[] {\n  return transformDocumentResults(docIds, results);\n}\n\nfunction toEntityRecognitionResult(\n  docIds: string[],\n  results: GeneratedEntityRecognitionResult\n): EntityRecognitionResult[] {\n  return transformDocumentResults(docIds, results);\n}\n\n/**\n * @internal\n */\nexport function transformActionResult<ActionName extends AnalyzeActionName>(\n  actionName: ActionName,\n  docIds: string[],\n  response: AnalyzeResponse\n): AnalyzeResult<AnalyzeActionName> {\n  switch (response.kind) {\n    case \"EntityLinkingResults\": {\n      return toEntityLinkingResult(docIds, (response as EntityLinkingTaskResult).results);\n    }\n    case \"EntityRecognitionResults\": {\n      return toEntityRecognitionResult(docIds, (response as EntitiesTaskResult).results);\n    }\n    case \"KeyPhraseExtractionResults\": {\n      return toKeyPhraseExtractionResult(docIds, (response as KeyPhraseTaskResult).results);\n    }\n    case \"PiiEntityRecognitionResults\": {\n      return toPiiEntityRecognitionResult(docIds, (response as PiiTaskResult).results);\n    }\n    case \"SentimentAnalysisResults\": {\n      return toSentimentAnalysisResult(docIds, (response as SentimentTaskResult).results);\n    }\n    case \"LanguageDetectionResults\": {\n      return toLanguageDetectionResult(docIds, (response as LanguageDetectionTaskResult).results);\n    }\n    default: {\n      const __exhaust: never = response;\n      throw new Error(`Unsupported results kind: ${__exhaust} for an action of type ${actionName}`);\n    }\n  }\n}\n\nfunction appendReadableErrorMessage(currentMessage: string, innerMessage: string): string {\n  let message = currentMessage;\n  if (message.slice(-1) !== \".\") {\n    message = message + \".\";\n  }\n  return message + \" \" + innerMessage;\n}\n\n/**\n * @internal\n * parses incoming errors from the service/\n * @param error - the incoming error\n */\nfunction transformError(errorResponse: unknown): any {\n  const strongErrorResponse = errorResponse as {\n    response: {\n      parsedBody?: ErrorResponse;\n    };\n    statusCode: number;\n  };\n  if (!strongErrorResponse.response) {\n    throw errorResponse;\n  }\n  const topLevelError = strongErrorResponse.response.parsedBody?.error;\n  if (!topLevelError) return errorResponse;\n  let errorMessage = topLevelError.message;\n  let code = topLevelError.code;\n  function unwrap(error: ErrorModel | InnerErrorModel): ErrorModel {\n    const innerError = error.innererror;\n    if (innerError) {\n      if (innerError.message) {\n        errorMessage = appendReadableErrorMessage(errorMessage, innerError.message);\n      }\n      if (innerError.code) {\n        code = innerError.code;\n      }\n      return unwrap(innerError);\n    }\n    return error as ErrorModel;\n  }\n  unwrap(topLevelError);\n  return new RestError(errorMessage, {\n    code,\n    statusCode: strongErrorResponse.statusCode,\n  });\n}\n\nexport async function throwError<T>(p: Promise<T>): Promise<T> {\n  try {\n    return await p;\n  } catch (e: unknown) {\n    throw transformError(e);\n  }\n}\n\nfunction toHealthcareResult(\n  docIds: string[],\n  results: GeneratedHealthcareResult\n): HealthcareResult[] {\n  function makeHealthcareEntity(entity: GeneratedHealthcareEntity): HealthcareEntity {\n    const { dataSources, ...rest } = entity;\n    return {\n      dataSources: dataSources ?? [],\n      ...rest,\n    };\n  }\n  function makeHealthcareRelation(\n    entities: HealthcareEntity[]\n  ): (relation: HealthcareRelation) => HealthcareEntityRelation {\n    return ({\n      entities: generatedEntities,\n      relationType,\n      confidenceScore,\n    }: HealthcareRelation): HealthcareEntityRelation => ({\n      relationType: relationType,\n      confidenceScore,\n      roles: generatedEntities.map(\n        (role: HealthcareRelationEntity): HealthcareEntityRelationRole => ({\n          entity: entities[parseHealthcareEntityIndex(role.ref)],\n          name: role.role,\n        })\n      ),\n    });\n  }\n  return transformDocumentResults<HealthcareEntitiesDocumentResult, HealthcareSuccessResult>(\n    docIds,\n    results,\n    {\n      processSuccess: ({ entities, relations, ...rest }) => {\n        const newEntities = entities.map(makeHealthcareEntity);\n        return {\n          entities: newEntities,\n          entityRelations: relations.map(makeHealthcareRelation(newEntities)),\n          ...rest,\n        };\n      },\n    }\n  );\n}\n\n/**\n * @internal\n */\nexport function transformAnalyzeBatchResults(\n  docIds: string[],\n  response: AnalyzeTextLROResultUnion[] = [],\n  errors: ErrorModel[] = []\n): AnalyzeBatchResult[] {\n  const errorMap = toIndexErrorMap(errors);\n  return response.map((actionData, idx): AnalyzeBatchResult => {\n    const { lastUpdateDateTime: completedOn, actionName, kind: resultKind } = actionData;\n    const error = errorMap.get(idx);\n    switch (resultKind as KnownAnalyzeTextLROResultsKind) {\n      case \"SentimentAnalysisLROResults\": {\n        const kind = \"SentimentAnalysis\";\n        if (actionData.status === \"failed\") {\n          return returnErrorTask(kind, error, completedOn);\n        }\n        const { results } = actionData as SentimentLROResult;\n        const { modelVersion, statistics } = results;\n        return {\n          kind,\n          results: toSentimentAnalysisResult(docIds, results),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          modelVersion,\n        };\n      }\n      case \"EntityRecognitionLROResults\": {\n        const kind = \"EntityRecognition\";\n        if (actionData.status === \"failed\") {\n          return returnErrorTask(kind, error, completedOn);\n        }\n        const { results } = actionData as EntityRecognitionLROResult;\n        const { modelVersion, statistics } = results;\n        return {\n          kind: \"EntityRecognition\",\n          results: toEntityRecognitionResult(docIds, results),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          modelVersion,\n        };\n      }\n      case \"PiiEntityRecognitionLROResults\": {\n        const kind = \"PiiEntityRecognition\";\n        if (actionData.status === \"failed\") {\n          return returnErrorTask(kind, error, completedOn);\n        }\n        const { results } = actionData as PiiEntityRecognitionLROResult;\n        const { modelVersion, statistics } = results;\n        return {\n          kind,\n          results: toPiiEntityRecognitionResult(docIds, results),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          modelVersion,\n        };\n      }\n      case \"KeyPhraseExtractionLROResults\": {\n        const kind = \"KeyPhraseExtraction\";\n        if (actionData.status === \"failed\") {\n          return returnErrorTask(kind, error, completedOn);\n        }\n        const { results } = actionData as KeyPhraseExtractionLROResult;\n        const { modelVersion, statistics } = results;\n        return {\n          kind,\n          results: toKeyPhraseExtractionResult(docIds, results),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          modelVersion,\n        };\n      }\n      case \"EntityLinkingLROResults\": {\n        const kind = \"EntityLinking\";\n        if (actionData.status === \"failed\") {\n          return returnErrorTask(kind, error, completedOn);\n        }\n        const { results } = actionData as EntityLinkingLROResult;\n        const { modelVersion, statistics } = results;\n        return {\n          kind,\n          results: toEntityLinkingResult(docIds, results),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          modelVersion,\n        };\n      }\n      case \"HealthcareLROResults\": {\n        const kind = \"Healthcare\";\n        if (actionData.status === \"failed\") {\n          return returnErrorTask(kind, error, completedOn);\n        }\n        const { results } = actionData as HealthcareLROResult;\n        const { modelVersion, statistics } = results;\n        return {\n          kind,\n          results: toHealthcareResult(docIds, results),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          modelVersion,\n        };\n      }\n      case \"CustomEntityRecognitionLROResults\": {\n        const kind = \"CustomEntityRecognition\";\n        if (actionData.status === \"failed\") {\n          return returnErrorCustomTask(kind, error, completedOn);\n        }\n        const { results } = actionData as CustomEntityRecognitionLROResult;\n        const { deploymentName, projectName, statistics } = results;\n        return {\n          kind,\n          results: transformDocumentResults<CustomEntitiesResultDocumentsItem>(docIds, results),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          deploymentName,\n          projectName,\n        };\n      }\n      case \"CustomSingleLabelClassificationLROResults\": {\n        const kind = \"CustomSingleLabelClassification\";\n        if (actionData.status === \"failed\") {\n          return returnErrorCustomTask(kind, error, completedOn);\n        }\n        const { results } = actionData as CustomSingleLabelClassificationLROResult;\n        const { deploymentName, projectName, statistics } = results;\n        return {\n          kind,\n          results: transformDocumentResults<CustomLabelClassificationResultDocumentsItem>(\n            docIds,\n            results\n          ),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          deploymentName,\n          projectName,\n        };\n      }\n      case \"CustomMultiLabelClassificationLROResults\": {\n        const kind = \"CustomMultiLabelClassification\";\n        if (actionData.status === \"failed\") {\n          return returnErrorCustomTask(kind, error, completedOn);\n        }\n        const { results } = actionData as CustomMultiLabelClassificationLROResult;\n        const { deploymentName, projectName, statistics } = results;\n        return {\n          kind,\n          results: transformDocumentResults<CustomLabelClassificationResultDocumentsItem>(\n            docIds,\n            results\n          ),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          deploymentName,\n          projectName,\n        };\n      }\n      case \"ExtractiveSummarizationLROResults\": {\n        const kind = \"ExtractiveSummarization\";\n        if (actionData.status === \"failed\") {\n          return returnErrorTask(kind, error, completedOn);\n        }\n        const { results } = actionData as ExtractiveSummarizationLROResult;\n        const { modelVersion, statistics } = results;\n        return {\n          kind: \"ExtractiveSummarization\",\n          results: transformDocumentResults(docIds, results),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          modelVersion,\n        };\n      }\n      case \"AbstractiveSummarizationLROResults\": {\n        const kind = \"AbstractiveSummarization\";\n        if (actionData.status === \"failed\") {\n          return returnErrorTask(kind, error, completedOn);\n        }\n        const { results } = actionData as AbstractiveSummarizationLROResult;\n        const { modelVersion, statistics } = results;\n        return {\n          kind: \"AbstractiveSummarization\",\n          results: transformDocumentResults(docIds, results),\n          completedOn,\n          ...(actionName ? { actionName } : {}),\n          ...(statistics ? { statistics } : {}),\n          modelVersion,\n        };\n      }\n      default: {\n        throw new Error(`Unsupported results kind: ${resultKind}`);\n      }\n    }\n  });\n}\n/**\n * @internal\n * Transform a list of error into index and error Map\n */\nfunction toIndexErrorMap(errors: ErrorModel[]): Map<number, TextAnalysisError> {\n  const errorMap = new Map<number, TextAnalysisError>();\n  for (const error of errors) {\n    const position = extractErrorPointerIndex(error);\n    const { target, ...errorWithoutTarget } = error;\n    errorMap.set(position, toTextAnalysisError(errorWithoutTarget));\n  }\n  return errorMap;\n}\n\n/**\n * Return the error for non-custom task\n *\n * @param kind - non custom task kind\n * @param error - error returned from the service\n * @param failedOn - the LastUpdateDateTime from the service\n * @returns - AnalyzeBatchResult with error\n */\nfunction returnErrorTask(\n  kind: AnalyzeBatchActionName,\n  error: TextAnalysisError | undefined,\n  failedOn: Date\n): AnalyzeBatchResult {\n  if (!error) {\n    throw new Error(\"Unexpected response from service - no errors for missing action results.\");\n  }\n  return {\n    kind,\n    modelVersion: \"\",\n    failedOn,\n    error,\n  } as AnalyzeBatchResult;\n}\n/**\n * Return the error for non-custom task\n *\n * @param kind - non custom task kind\n * @param error - error returned from the service\n * @param failedOn - the LastUpdateDateTime from the service\n * @returns AnalyzeBatchResult for custom task with error\n */\nfunction returnErrorCustomTask(\n  kind: AnalyzeBatchActionName,\n  error: TextAnalysisError | undefined,\n  failedOn: Date\n): AnalyzeBatchResult {\n  if (!error) {\n    throw new Error(\"Unexpected response from service - no errors for missing action results.\");\n  }\n  return {\n    kind,\n    projectName: \"\",\n    deploymentName: \"\",\n    failedOn,\n    error,\n  } as AnalyzeBatchResult;\n}\n"]}